<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
		<title>Cryptodemo</title>
	<style>
		body{
			font-family:sans-serif;
		}
	</style>
</head><body>
<div>
  <textarea id='msg'>Message</textarea>
</div>
<div>
	<input type="" id="pwd" value="Password">
</div>
<div>
  <button id="encBtn" onclick="encrypt()">Encrypt</button>
</div>
<div id="disp"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sjcl/1.0.0/sjcl.min.js"></script>
<script>
/*
	encrypt tag (128) + random first 2 bits + version (4 bits) (1 byte)
	protocol (1 byte)
	key strength factor (2 bytes)
*/
function encrypt(){
	var rand = sjcl.random.randomWords(8);
	var salt = rand.slice(0,4);
	var nonce = rand.slice(4);
	var iter = 1024;
	var params = 128 + ((rand[0]>>>30)<<4);
	var key = sjcl.misc.pbkdf2(pwd.value, salt, iter);
	var plaintext = sjcl.codec.utf8String.toBits(msg.innerHTML);
	var prf = new sjcl.cipher.aes(key);
	var ciphertext = sjcl.mode.gcm.encrypt(prf, plaintext, nonce, rand);
	var toHex = sjcl.codec.hex.fromBits;
	disp.innerHTML = [toHex(salt),toHex(nonce),toHex(key),toHex(plaintext),toHex(ciphertext),toHex(params)].join('<br>');
}
</script>
</body>
</html>
